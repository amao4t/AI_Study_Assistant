{% extends "base.html" %}

{% block title %}Study Assistant - AI Assistant{% endblock %}

{% block content %}
<div class="dashboard-container">
    <div class="dashboard-header">
        <h1>AI Assistant</h1>
        <p>Your intelligent study assistant and coach</p>
    </div>
    
    <div class="dashboard-content">
        <div class="row">
            <!-- Tools Panel -->
            <div class="col-md-4">
                <div class="card">
                    <div class="card-header">
                        <h3>Study Tools</h3>
                    </div>
                    <div class="card-body">
                        <div class="tools-list">
                            <div class="tool-item active" data-tool="chat">
                                <div class="tool-icon">
                                    <i class="fas fa-comments"></i>
                                </div>
                                <div class="tool-info">
                                    <h4>Chat with AI Assistant</h4>
                                    <p>Ask questions and get study advice</p>
                                </div>
                            </div>
                            
                            <div class="tool-item" data-tool="plan">
                                <div class="tool-icon">
                                    <i class="fas fa-calendar-alt"></i>
                                </div>
                                <div class="tool-info">
                                    <h4>Study Plan</h4>
                                    <p>Create a personalized study schedule</p>
                                </div>
                            </div>
                            
                            <div class="tool-item" data-tool="resources">
                                <div class="tool-icon">
                                    <i class="fas fa-book"></i>
                                </div>
                                <div class="tool-info">
                                    <h4>Resources</h4>
                                    <p>Get recommended learning materials</p>
                                </div>
                            </div>
                            
                            <div class="tool-item" data-tool="techniques">
                                <div class="tool-icon">
                                    <i class="fas fa-brain"></i>
                                </div>
                                <div class="tool-info">
                                    <h4>Study Techniques</h4>
                                    <p>Learn effective study methods</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Study Sessions -->
                <div class="card mt-4">
                    <div class="card-header">
                        <h3>Study Sessions</h3>
                    </div>
                    <div class="card-body">
                        <div id="sessions-list" class="sessions-list">
                            <div class="empty-state">
                                <i class="fas fa-clock"></i>
                                <p>No study sessions recorded yet. Start a session to track your progress.</p>
                            </div>
                        </div>
                        <button id="start-session-btn" class="btn btn-primary mt-3">Start New Session</button>
                    </div>
                </div>
            </div>
            
            <!-- Main Content Panel -->
            <div class="col-md-8">
                <!-- Chat Tool -->
                <div id="chat-tool" class="tool-panel">
                    <div class="card chat-card">
                        <div class="card-header">
                            <h3>Chat with AI Assistant</h3>
                        </div>
                        <div class="card-body">
                            <div id="chat-container" class="chat-container">
                                <div class="chat-welcome">
                                    <div class="chat-welcome-icon">
                                        <i class="fas fa-robot"></i>
                                    </div>
                                    <h3>Hello, I'm your AI Assistant!</h3>
                                    <p>I can help you with study techniques, scheduling, staying motivated, and answering questions about your subjects. What would you like help with today?</p>
                                </div>
                            </div>
                        </div>
                        <div class="card-footer">
                            <form id="chat-form" class="chat-input-form">
                                <div class="input-group">
                                    <input type="text" id="chat-input" class="form-control" placeholder="Type your message..." required>
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fas fa-paper-plane"></i>
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
                
                <!-- Plan Tool -->
                <div id="plan-tool" class="tool-panel" style="display: none;">
                    <div class="card">
                        <div class="card-header">
                            <h3>Create Study Plan</h3>
                        </div>
                        <div class="card-body">
                            <form id="plan-form">
                                <div class="form-group">
                                    <label for="subject" class="form-label">Subject or Course</label>
                                    <input type="text" id="subject" name="subject" class="form-control" placeholder="E.g., Calculus, History, Physics" required>
                                </div>
                                
                                <div class="form-group">
                                    <label for="goal" class="form-label">Learning Goal</label>
                                    <input type="text" id="goal" name="goal" class="form-control" placeholder="E.g., Pass final exam, Complete project" required>
                                </div>
                                
                                <div class="form-group">
                                    <label for="timeframe" class="form-label">Timeframe</label>
                                    <input type="text" id="timeframe" name="timeframe" class="form-control" placeholder="E.g., 2 weeks, 3 months" required>
                                </div>
                                
                                <div class="form-group">
                                    <label for="hours-per-week" class="form-label">Hours Available Per Week</label>
                                    <input type="number" id="hours-per-week" name="hours_per_week" class="form-control" min="1" max="50" value="10" required>
                                </div>
                                
                                <div class="form-group">
                                    <button type="submit" class="btn btn-primary">Generate Study Plan</button>
                                </div>
                            </form>
                            
                            <div id="plan-result" class="plan-result" style="display: none;">
                                <h4>Your Personalized Study Plan</h4>
                                <div id="plan-overview" class="plan-overview"></div>
                                
                                <h5 class="mt-4">Weekly Schedule</h5>
                                <div id="plan-weeks" class="plan-weeks"></div>
                                
                                <h5 class="mt-4">Recommended Study Techniques</h5>
                                <div id="plan-techniques" class="plan-techniques"></div>
                                
                                <h5 class="mt-4">Milestones & Progress Tracking</h5>
                                <div id="plan-milestones" class="plan-milestones"></div>
                                
                                <div class="plan-actions mt-4">
                                    <button id="save-plan-btn" class="btn btn-primary">Save Plan</button>
                                    <button id="print-plan-btn" class="btn btn-outline">Print</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Resources Tool -->
                <div id="resources-tool" class="tool-panel" style="display: none;">
                    <div class="card">
                        <div class="card-header">
                            <h3>Learning Resources</h3>
                        </div>
                        <div class="card-body">
                            <form id="resources-form">
                                <div class="form-group">
                                    <label for="resources-subject" class="form-label">Subject</label>
                                    <input type="text" id="resources-subject" name="subject" class="form-control" placeholder="E.g., Machine Learning, European History" required>
                                </div>
                                
                                <div class="form-group">
                                    <label for="level" class="form-label">Education Level</label>
                                    <select id="level" name="level" class="form-control">
                                        <option value="high_school">High School</option>
                                        <option value="undergraduate" selected>Undergraduate</option>
                                        <option value="graduate">Graduate</option>
                                        <option value="professional">Professional</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">Resource Type</label>
                                    <div class="form-check">
                                        <input type="radio" id="all-resources" name="resource_type" value="all" class="form-check-input" checked>
                                        <label for="all-resources" class="form-check-label">All Types</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="radio" id="books" name="resource_type" value="books" class="form-check-input">
                                        <label for="books" class="form-check-label">Books</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="radio" id="online" name="resource_type" value="online" class="form-check-input">
                                        <label for="online" class="form-check-label">Online Courses</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="radio" id="videos" name="resource_type" value="videos" class="form-check-input">
                                        <label for="videos" class="form-check-label">Videos</label>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <button type="submit" class="btn btn-primary">Find Resources</button>
                                </div>
                            </form>
                            
                            <div id="resources-result" class="resources-result" style="display: none;">
                                <h4>Recommended Resources</h4>
                                <div id="resources-list" class="resources-list"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Techniques Tool -->
                <div id="techniques-tool" class="tool-panel" style="display: none;">
                    <div class="card">
                        <div class="card-header">
                            <h3>Study Techniques</h3>
                        </div>
                        <div class="card-body">
                            <form id="techniques-form">
                                <div class="form-group">
                                    <label for="techniques-subject" class="form-label">Subject</label>
                                    <input type="text" id="techniques-subject" name="subject" class="form-control" placeholder="E.g., Mathematics, Foreign Language" required>
                                </div>
                                
                                <div class="form-group">
                                    <label for="learning-style" class="form-label">Learning Style (Optional)</label>
                                    <select id="learning-style" name="learning_style" class="form-control">
                                        <option value="">Not Sure</option>
                                        <option value="visual">Visual</option>
                                        <option value="auditory">Auditory</option>
                                        <option value="reading_writing">Reading/Writing</option>
                                        <option value="kinesthetic">Kinesthetic</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <button type="submit" class="btn btn-primary">Suggest Techniques</button>
                                </div>
                            </form>
                            
                            <div id="techniques-result" class="techniques-result" style="display: none;">
                                <h4>Recommended Study Techniques</h4>
                                <div id="techniques-list" class="techniques-list"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Session Modal -->
<div class="modal" id="session-modal">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Study Session</h4>
                <button type="button" class="modal-close" aria-label="Close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div id="session-form-container">
                    <form id="session-form">
                        <div class="form-group">
                            <label for="session-type" class="form-label">Session Type</label>
                            <select id="session-type" name="session_type" class="form-control">
                                <option value="general">General Study</option>
                                <option value="reading">Reading</option>
                                <option value="practice">Practice Problems</option>
                                <option value="review">Review</option>
                                <option value="quiz">Quiz/Test Prep</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="session-document" class="form-label">Document (Optional)</label>
                            <select id="session-document" name="document_id" class="form-control">
                                <option value="">None</option>
                                <!-- Documents will be populated via JavaScript -->
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="session-notes" class="form-label">Session Notes</label>
                            <textarea id="session-notes" name="notes" class="form-control" placeholder="What are you planning to study? What are your goals for this session?"></textarea>
                        </div>
                        
                        <div class="form-group">
                            <button type="submit" class="btn btn-primary btn-block">Start Session</button>
                        </div>
                    </form>
                </div>
                
                <div id="active-session-container" style="display: none;">
                    <div class="session-timer">
                        <div class="timer-display">
                            <span id="timer-hours">00</span>:<span id="timer-minutes">00</span>:<span id="timer-seconds">00</span>
                        </div>
                    </div>
                    
                    <div class="session-info">
                        <p><strong>Session Type:</strong> <span id="active-session-type"></span></p>
                        <p><strong>Started:</strong> <span id="active-session-start"></span></p>
                    </div>
                    
                    <div class="form-group">
                        <label for="active-session-notes" class="form-label">Session Notes</label>
                        <textarea id="active-session-notes" class="form-control" placeholder="Take notes about what you've learned..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <button id="end-session-btn" class="btn btn-danger btn-block">End Session</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block custom_css %}
<style>
    .dashboard-container {
        padding: var(--spacing-lg) 0;
    }
    
    .dashboard-header {
        margin-bottom: var(--spacing-xl);
    }
    
    .dashboard-header h1 {
        color: var(--primary-color);
        margin-bottom: var(--spacing-xs);
    }
    
    .dashboard-header p {
        color: var(--text-secondary);
        font-size: var(--font-size-lg);
    }
    
    .row {
        display: flex;
        flex-wrap: wrap;
        gap: var(--spacing-lg);
    }
    
    .col-md-4 {
        flex: 1;
        min-width: 300px;
    }
    
    .col-md-8 {
        flex: 2;
        min-width: 400px;
    }
    
    .tools-list {
        display: flex;
        flex-direction: column;
        gap: var(--spacing-md);
    }
    
    .tool-item {
        display: flex;
        align-items: center;
        gap: var(--spacing-md);
        padding: var(--spacing-md);
        border-radius: var(--radius-md);
        background-color: var(--bg-secondary);
        cursor: pointer;
        transition: all var(--transition-fast);
    }
    
    .tool-item:hover {
        background-color: var(--primary-light);
    }
    
    .tool-item.active {
        background-color: var(--primary-light);
        border-left: 3px solid var(--primary-color);
    }
    
    .tool-icon {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 40px;
        height: 40px;
        background-color: var(--bg-color);
        color: var(--primary-color);
        border-radius: var(--radius-full);
        font-size: var(--font-size-lg);
    }
    
    .tool-info {
        flex: 1;
    }
    
    .tool-info h4 {
        margin-bottom: var(--spacing-xs);
        color: var(--text-color);
    }
    
    .tool-info p {
        margin: 0;
        font-size: var(--font-size-sm);
        color: var(--text-secondary);
    }
    
    .chat-card {
        display: flex;
        flex-direction: column;
        height: 700px;
    }
    
    .chat-container {
        flex: 1;
        overflow-y: auto;
        padding: var(--spacing-md);
        display: flex;
        flex-direction: column;
        gap: var(--spacing-md);
        height: 600px;
    }
    
    .chat-welcome {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        text-align: center;
        height: 100%;
        color: var(--text-secondary);
        padding: var(--spacing-xl);
    }
    
    .chat-welcome-icon {
        font-size: 3rem;
        color: var(--primary-light);
        margin-bottom: var(--spacing-lg);
    }
    
    .chat-welcome h3 {
        margin-bottom: var(--spacing-md);
        color: var(--text-color);
    }
    
    .chat-bubble {
        max-width: 80%;
        padding: var(--spacing-md);
        border-radius: var(--radius-md);
    }
    
    .chat-bubble.user {
        align-self: flex-end;
        background-color: var(--primary-color);
        color: white;
        border-bottom-right-radius: 0;
    }
    
    .chat-bubble.bot {
        align-self: flex-start;
        background-color: var(--bg-secondary);
        color: var(--text-color);
        border-bottom-left-radius: 0;
    }
    
    .chat-input-form {
        padding: var(--spacing-sm) 0;
    }
    
    .sessions-list {
        max-height: 300px;
        overflow-y: auto;
    }
    
    .session-item {
        padding: var(--spacing-md);
        margin-bottom: var(--spacing-sm);
        border-radius: var(--radius-md);
        background-color: var(--bg-secondary);
    }
    
    .session-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: var(--spacing-xs);
    }
    
    .session-title {
        font-weight: 600;
        color: var(--text-color);
    }
    
    .session-duration {
        font-size: var(--font-size-xs);
        color: var(--primary-color);
    }
    
    .session-meta {
        font-size: var(--font-size-sm);
        color: var(--text-secondary);
    }
    
    .empty-state {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: var(--spacing-xl);
        color: var(--text-secondary);
        text-align: center;
    }
    
    .empty-state i {
        font-size: 2rem;
        margin-bottom: var(--spacing-md);
        opacity: 0.5;
    }
    
    .plan-result,
    .resources-result,
    .techniques-result {
        margin-top: var(--spacing-xl);
        padding-top: var(--spacing-lg);
        border-top: 1px solid var(--border-color);
    }
    
    .plan-overview {
        padding: var(--spacing-md);
        background-color: var(--bg-secondary);
        border-radius: var(--radius-md);
        margin-top: var(--spacing-md);
    }
    
    .plan-week {
        padding: var(--spacing-md);
        margin-bottom: var(--spacing-md);
        background-color: var(--bg-secondary);
        border-radius: var(--radius-md);
    }
    
    .plan-week-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: var(--spacing-sm);
    }
    
    .technique-item,
    .resource-item,
    .milestone-item {
        padding: var(--spacing-md);
        margin-bottom: var(--spacing-md);
        background-color: var(--bg-secondary);
        border-radius: var(--radius-md);
    }
    
    .technique-title,
    .resource-title,
    .milestone-title {
        font-weight: 600;
        margin-bottom: var(--spacing-xs);
        color: var(--text-color);
    }
    
    .resource-meta {
        display: flex;
        gap: var(--spacing-md);
        margin-bottom: var(--spacing-xs);
        font-size: var(--font-size-sm);
        color: var(--text-secondary);
    }
    
    .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        z-index: 1000;
        align-items: center;
        justify-content: center;
    }
    
    .modal.show {
        display: flex;
    }
    
    .modal-dialog {
        width: 100%;
        max-width: 500px;
        margin: auto;
    }
    
    .modal-content {
        background-color: var(--bg-color);
        border-radius: var(--radius-lg);
        box-shadow: var(--shadow-lg);
        overflow: hidden;
    }
    
    .modal-header {
        padding: var(--spacing-md) var(--spacing-lg);
        display: flex;
        align-items: center;
        justify-content: space-between;
        border-bottom: 1px solid var(--border-color);
    }
    
    .modal-body {
        padding: var(--spacing-lg);
    }
    
    .modal-close {
        background: none;
        border: none;
        color: var(--text-secondary);
        cursor: pointer;
        font-size: var(--font-size-lg);
    }
    
    .session-timer {
        display: flex;
        justify-content: center;
        margin-bottom: var(--spacing-xl);
    }
    
    .timer-display {
        font-size: 3rem;
        font-weight: 700;
        color: var(--primary-color);
        font-family: monospace;
    }
    
    .btn-block {
        width: 100%;
    }
    
    .form-check {
        display: flex;
        align-items: flex-start;
        gap: var(--spacing-sm);
        margin-bottom: var(--spacing-sm);
    }
    
    .form-check-input {
        margin-top: 4px;
    }
    
    .form-check-label {
        margin: 0;
    }
</style>
{% endblock %}

{% block custom_js %}
<script src="{{ url_for('static', filename='js/study.js') }}"></script>
{% endblock %}